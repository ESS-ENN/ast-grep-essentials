id: desede-is-deprecated-java
language: java
severity: warning
message: >-
    Triple DES (3DES or DESede) is considered deprecated. AES is the recommended cipher. Upgrade to use AES.
note: >-
  [CWE-326]: Inadequate Encryption Strength
  [OWASP A03:2017]: Sensitive Data Exposure
  [OWASP A02:2021]: Cryptographic Failures
  [REFERENCES]
      - https://find-sec-bugs.github.io/bugs.htm#TDES_USAGE
      - https://csrc.nist.gov/News/2017/Update-to-Current-Use-and-Deprecation-of-TDEA
utils:
      match_method_invocation:
            kind: method_invocation
            all:
                  - has:
                        stopBy: end
                        kind: identifier
                  - has:
                        stopBy: end
                        kind: identifier
                        regex: '^getInstance$'
            has:
                  stopBy: end
                  kind: argument_list
                  has:
                        stopBy: end
                        kind: string_literal
                        regex: 'DESede'
      match_key_generator:
            kind: method_invocation
            nthChild: 1
            all:
            - has:
                  stopBy: end
                  kind: field_access
                  field: object
            - has:
                  stopBy: end
                  kind: identifier
                  regex: '^KeyGenerator$'
rule:
      any:
            - matches: match_method_invocation
            - matches: match_key_generator

                     
            

