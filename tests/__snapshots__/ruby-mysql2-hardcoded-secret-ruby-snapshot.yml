id: ruby-mysql2-hardcoded-secret-ruby
snapshots:
  ? |
    $LOAD_PATH.unshift 'lib'
    require 'mysql2'
    require 'timeout'
    def connect_to_db
    Mysql2::Client.new(host: "localhost", username: "root", password: "complex-hardcoded-password")
    end
  : labels:
    - source: 'Mysql2::Client.new(host: "localhost", username: "root", password: "complex-hardcoded-password")'
      style: primary
      start: 78
      end: 173
    - source: Mysql2::Client
      style: secondary
      start: 78
      end: 92
    - source: .
      style: secondary
      start: 92
      end: 93
    - source: new
      style: secondary
      start: 93
      end: 96
    - source: password
      style: secondary
      start: 134
      end: 142
    - source: complex-hardcoded-password
      style: secondary
      start: 145
      end: 171
    - source: '"complex-hardcoded-password"'
      style: secondary
      start: 144
      end: 172
    - source: 'password: "complex-hardcoded-password"'
      style: secondary
      start: 134
      end: 172
    - source: '(host: "localhost", username: "root", password: "complex-hardcoded-password")'
      style: secondary
      start: 96
      end: 173
    - source: require 'mysql2'
      style: secondary
      start: 25
      end: 41
    - source: |
        $LOAD_PATH.unshift 'lib'
        require 'mysql2'
        require 'timeout'
        def connect_to_db
        Mysql2::Client.new(host: "localhost", username: "root", password: "complex-hardcoded-password")
        end
      style: secondary
      start: 0
      end: 178
  ? "class DatabaseConnection\ndef self.connect\npassword = \"class-hardcoded-password\"\nMysql2::Client.new(host: \"localhost\", username: \"admin\", password: password)\nend \nend\n"
  : labels:
    - source: 'Mysql2::Client.new(host: "localhost", username: "admin", password: password)'
      style: primary
      start: 80
      end: 156
    - source: Mysql2
      style: secondary
      start: 80
      end: 86
    - source: Client
      style: secondary
      start: 88
      end: 94
    - source: Mysql2::Client
      style: secondary
      start: 80
      end: 94
    - source: new
      style: secondary
      start: 95
      end: 98
    - source: host
      style: secondary
      start: 99
      end: 103
    - source: localhost
      style: secondary
      start: 106
      end: 115
    - source: '"localhost"'
      style: secondary
      start: 105
      end: 116
    - source: 'host: "localhost"'
      style: secondary
      start: 99
      end: 116
    - source: host
      style: secondary
      start: 99
      end: 103
    - source: localhost
      style: secondary
      start: 106
      end: 115
    - source: '"localhost"'
      style: secondary
      start: 105
      end: 116
    - source: 'host: "localhost"'
      style: secondary
      start: 99
      end: 116
    - source: password
      style: secondary
      start: 137
      end: 145
    - source: password
      style: secondary
      start: 147
      end: 155
    - source: 'password: password'
      style: secondary
      start: 137
      end: 155
    - source: '(host: "localhost", username: "admin", password: password)'
      style: secondary
      start: 98
      end: 156
    - source: |-
        password = "class-hardcoded-password"
        Mysql2::Client.new(host: "localhost", username: "admin", password: password)
      style: secondary
      start: 42
      end: 156
    - source: password
      style: secondary
      start: 42
      end: 50
    - source: '"class-hardcoded-password"'
      style: secondary
      start: 53
      end: 79
    - source: password = "class-hardcoded-password"
      style: secondary
      start: 42
      end: 79
